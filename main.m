%% Clear all, clc, close all
clear all, clc, close all

%% Parametri iniziali
ore = 0:23;

% Sito profilo di carico (Azienda ...) Nord-Ovest d'Italia

% Soleggiamento Anno 2020 (W/m^2)
% Gennaio
% Matrice - righe corrispondono ai giorni del mese e 
% colonne corrispondono alle ore

Soleggiamento_Gen = [0 0 0 0 0 0 0 16 103 239 325 340 227 249 132 23 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 19 154 250 324 318 292 248 129 20 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 0 52 212 54 351 142 93 28 0 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 29 141 252 330 348 333 249 143 33 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 31 140 253 330 347 333 259 144 31 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 28 69 137 286 348 227 246 131 24 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 10 57 126 220 212 183 256 139 26 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 38 154 264 345 369 364 256 139 32 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 36 147 251 345 378 358 281 135 52 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 30 172 29 33 84 86 85 10 0 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 35 150 262 347 382 357 279 164 41 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 38 159 274 361 394 368 294 176 44 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 29 163 223 227 245 231 249 157 27 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 0 17 100 98 106 179 142 74 21 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 9 42 62 40 62 70 34 7 1 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 0 3 8 28 68 111 106 111 43 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 38 75 51 57 6 40 3 1 0 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 65 135 286 376 415 385 301 183 35 0 0 0 0 0 0 0 0;
                                    0 0	0 0	0 0	0 41 152 271 396 457 469 237 131 21 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 12 60 210 387 359 382 373 120 29 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 16 125 166 170 201 161 186 117 27 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 10 112 268 289 350 383 308 185 51 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 43 158 284 372 407 384 311 195 57 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 29 71 199 193 88 29 37 30 3 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 4 34 144 303 302 248 214 101 18 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 45 181 293 408 240 369 277 186 92 1 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 32 130 280 244 290 351 309 63 18 0 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 0 26 135 229 390 426 358 180 79 3 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 33 164 307 411 454 433 350 233 85 1 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 29 58 127 221 289 286 177 185 77 3 0 0 0 0 0 0 0;
                                    0 0 0 0 0 0 0 1 33 51 88 49 40 58 19 0 0 0 0 0 0 0 0 0;];



%ottobre - gennaio
PloadH = [195 187 180 167 167.5 169.5 175 173 220 232 240 245 225 212 213 235 248 250 249.5 247.5 240 230 218 213]; %KW
%febbraio-aprile e luglio-settembre
PloadI = [85 82 81.8 75 74.8 74.9 64 74.3 102 118 121 120 100 77 103 112 114 121 120 105 104 105 102 101]; %KW
%maggio-giugno
PloadL = [15 15 15 14 14 14 8 7 7 7 7 7 7 7 7 7 7 7 7 7 8 12.5 13 13]; %KW

p(1:24) = 0;

figure(1)
plot(ore, PloadL, ore, PloadI)

% Batteria - PowerWall 2 - Tesla da 14 KWh - Costo â‚¬ 6.000 
% Scarica e carica batteria 5 KWh, per 10 secondi 7 KWh
carica_scarica_per_ora = 5; % KWh

Capacita_Batteria = 14; %KWh
Numero_batterie = 1;

% Range di mantenimento dello stato di carica
% SOC - stato di carica
SOCmax = 90; % percento
SOCmin = 10; % percento



